<!--
  Copyright (c) 2006-2013, JGraph Ltd
  
  Folding example for mxGraph. This example demonstrates
  using a layout to implement a nested group structure.
-->
<html>

<head>
    <title>Hierarchical example for mxGraph</title>

    <!-- Sets the basepath for the library if not in same directory -->
    <script type="text/javascript">
        mxBasePath = 'mxgraph';
    </script>

    <!-- Loads and initializes the library -->
    <script type="text/javascript" src="mxClient.js"></script>

    <!-- Example code -->
    <script type="text/javascript">
        var graph
        // Program starts here. Creates a sample graph in the
        // DOM node with the specified ID. This function is invoked
        // from the onLoad event handler of the document (see below).
        function main(container) {
            // Checks if the browser is supported
            if (!mxClient.isBrowserSupported()) {
                // Displays an error message if the browser is not supported.
                mxUtils.error('Browser is not supported!', 200, false);
            } else {
                // Enables crisp rendering of rectangles in SVG
                mxConstants.ENTITY_SEGMENT = 20;

                // Creates the graph inside the given container
                graph = new mxGraph(container);

                // Disables global features
                graph.collapseToPreferredSize = false;
                graph.constrainChildren = true;
                graph.cellsSelectable = false;
                graph.extendParentsOnAdd = false;
                graph.extendParents = true;
                graph.border = 10;

                graph.getModel().beginUpdate();
                try {
                    mkGraphWithGroups();
                } finally {
                    graph.getModel().endUpdate();
                    //graph.setCellsMovable(false);
                }
            }
        };

        mkGraphWithGroups = () => {
            vAB = graph.insertVertex(graph.getDefaultParent(), "vAB", "vAB", 0, 0, 200, 200);
            vCD = graph.insertVertex(graph.getDefaultParent(), "vCD", "vCD", 0, 0, 200, 200);
            vDE = graph.insertVertex(graph.getDefaultParent(), "vDE", "vDE", 0, 0, 200, 200);

            graph.insertEdge(graph.getDefaultParent(), null, "", vAB, vCD);
            graph.insertEdge(graph.getDefaultParent(), null, "", vAB, vDE);

            layoutGraph(graph.getDefaultParent());

            vA = graph.insertVertex(vAB, "vA", "vA", 0, 0, 50, 50);
            vB = graph.insertVertex(vAB, "vB", "vB", 0, 0, 50, 50);
            vC = graph.insertVertex(vCD, "vC", "vC", 0, 0, 50, 50);
            vD = graph.insertVertex(vCD, "vD", "vD", 0, 0, 50, 50);
            vX = graph.insertVertex(vCD, "vC", "vC", 0, 0, 50, 50);
            vY = graph.insertVertex(vCD, "vD", "vD", 0, 0, 50, 50);

            graph.insertEdge(vAB, null, "", vA, vB);
            graph.insertEdge(vCD, null, "", vC, vD);
            graph.insertEdge(vAB, null, "", vX, vY);

            layoutGraph(vCD);
        }

        layoutGraph = (objects) => {
            let direction = (objects.value && objects.value === 'vCD') ? mxConstants.DIRECTION_NORTH : mxConstants
                .DIRECTION_WEST;

            layout = new mxHierarchicalLayout(graph, direction);

            graph.getModel().beginUpdate();
            try {
                layout.execute(objects);
            } finally {
                graph.getModel().endUpdate();
            }
        }
    </script>
</head>

<!-- Page passes the container for the graph to the program -->

<body onload="main(document.getElementById('graphContainer'))">

    <!-- Creates a container for the graph with a grid wallpaper -->
    <div id="graphContainer">
    </div>
</body>

</html>